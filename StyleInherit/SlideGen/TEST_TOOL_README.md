# 测试工具使用说明

## 功能概述

测试工具用于批量测试PPT生成功能，检测不同场景下的爆版率。

## 使用方法

### 1. 打开测试工具

在应用右上角点击 **"🧪 测试工具"** 按钮，切换到测试工具界面。

### 2. 准备Excel文件

Excel文件要求：
- 第一个工作表（Sheet1）的第一行必须包含名为 **"输入语料"** 的列
- 从第二行开始，该列下的每个单元格包含一个测试主题（Prompt）

示例Excel结构：
```
| 输入语料          | ... |
|------------------|-----|
| 2024年度工作总结  | ... |
| 产品发布会PPT     | ... |
| 市场分析报告      | ... |
```

### 3. 配置参数

- **选择Excel文件**：点击文件选择按钮，选择准备好的Excel文件
- **选择模型**：输入要测试的模型名称（如：`glm-4.6`）
- **选择HTML模板**（可选）：如果选择模板，将执行场景2测试；不选择则只执行场景1

### 4. 开始处理

点击 **"开始处理"** 按钮，工具将：

1. 读取Excel中"输入语料"列的所有内容
2. 对每个主题执行4种场景的测试：
   - **场景1-无修复**：仅输入语料，不带模板，不自动修复
   - **场景1-有修复**：仅输入语料，不带模板，自动修复
   - **场景2-无修复**：输入语料+HTML模板，不自动修复（需选择模板）
   - **场景2-有修复**：输入语料+HTML模板，自动修复（需选择模板）

3. 对每种场景：
   - 生成PPT HTML
   - 检测是否爆版
   - 将HTML转换为PNG图片并保存
   - 将结果写入Excel

### 5. 结果输出

处理完成后：

- **Excel结果文件**：自动下载为 `原文件名_结果.xlsx`
- **PNG图片文件**：自动下载到浏览器默认下载目录，文件名格式：
  - `场景1_无修复_行X_时间戳.png`
  - `场景1_有修复_行X_时间戳.png`
  - `场景2_无修复_行X_时间戳.png`
  - `场景2_有修复_行X_时间戳.png`

### 6. Excel结果列说明

结果Excel文件包含以下列（从第4列开始）：

| 列 | 内容 | 说明 |
|---|------|------|
| 第4列 | 场景1-无修复图片文件名 | PNG文件名或base64（如果较短） |
| 第5列 | 场景1-无修复是否爆版 | "是" 或 "否" |
| 第6列 | 场景1-有修复图片文件名 | PNG文件名或base64（如果较短） |
| 第7列 | 场景1-有修复是否爆版 | "是" 或 "否" |
| 第8列 | 场景2-无修复图片文件名 | PNG文件名（仅在选择模板时） |
| 第9列 | 场景2-无修复是否爆版 | "是" 或 "否"（仅在选择模板时） |
| 第10列 | 场景2-有修复图片文件名 | PNG文件名（仅在选择模板时） |
| 第11列 | 场景2-有修复是否爆版 | "是" 或 "否"（仅在选择模板时） |

## 注意事项

1. **API限流**：每个测试项之间会有2秒延迟，避免API限流
2. **处理时间**：批量处理可能需要较长时间，请耐心等待
3. **PNG文件**：PNG图片会自动下载，请确保浏览器允许下载文件
4. **Excel格式**：建议使用 `.xlsx` 格式
5. **模板选择**：如果选择模板，场景2才会执行；不选择模板则只执行场景1

## 技术说明

- **Excel读取**：使用 `xlsx` 库
- **HTML转PNG**：使用 `html2canvas` 库
- **爆版检测**：使用项目内置的 `layout-checker` 工具
- **PPT生成**：使用项目内置的 `llmService` 服务

## 故障排除

1. **找不到"输入语料"列**：检查Excel第一行是否有该列名
2. **生成失败**：检查API配置和网络连接
3. **PNG保存失败**：检查浏览器下载权限
4. **Excel写入失败**：确保有写入权限

## 结果文件路径链接
【金山文档 | WPS云文档】 html评测
https://365.kdocs.cn/folder/ch1cdRu9Q8QL
